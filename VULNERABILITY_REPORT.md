# Security Vulnerability Assessment Report

**Project:** Gyan Niketan Admin (Firebase)
**Date:** 2026-01-03
**Severity Status:** âš ï¸ MODERATE RISK

## Executive Summary

A comprehensive security assessment was performed on the `gyan-niketan-admin` Firebase project using a custom penetration testing suite. The assessment tested for common misconfigurations, including authentication bypass, open data access, and privilege escalation.

**Key Finding:** While the database data is secure against unauthorized access, **Open User Registration is ENABLED**, allowing any unverified actor to create accounts on the platform.

---

## 1. Findings Detail

### ðŸš¨ Finding #1: Open User Registration (Unrestricted)

- **Severity:** **Medium**
- **Status:** **VULNERABLE**
- **Description:** The Firebase Authentication service allows public user registration via the `email/password` provider. An attacker can freely create thousands of valid user accounts using the client SDK.
- **Evidence:**
  ```bash
  [vuln] Open Registration is ENABLED. Created user: pentest_1767438892084@example.com
  ```
- **Impact:**
  - **Resource Exhaustion:** Attackers can flood the User database, potentially exceeding free tier limits or complicating user management.
  - **Attack Surface Expansion:** If any future security rule grants access to `auth != null` (any authenticated user), these attackers immediately gain that access.

### âœ… Finding #2: Data Access Controls (Firestore)

- **Severity:** Low (Secure)
- **Status:** **SECURE**
- **Description:** Extensive probing of sensitive collections (`users`, `admins`, `students`, `payments`, etc.) was performed using both Anonymous and Newly Registered accounts. All attempts were blocked by Firestore Security Rules.
- **Result:** Permission Denied (Code 7) for all Read/Write operations.

### âœ… Finding #3: Privilege Escalation

- **Severity:** Low (Secure)
- **Status:** **SECURE**
- **Description:** Attempted to force-write Administrative privileges to a user profile (Mass Assignment) and add a user to the `admins` collection.
- **Result:** Operations were successfully denied by the server.

### âœ… Finding #4: Dashboard Write Access (CMS Injection)

- **Severity:** Low (Secure)
- **Status:** **SECURE**
- **Description:** Attempted to inject malicious content into CMS collections (`gallery`, `news`, `faculty`, `results`, `notices`) using a newly created user account.
- **Result:** **DENIED**. Server security rules prevented the unauthorized user from posting content.

### âœ… Finding #5: Source Code Analysis

- **Severity:** Low (Secure)
- **Status:** **SECURE**
- **Description:** Application source code (`admin.html`, `dashboard.html`) was reviewed for hardcoded credentials, API secrets, or logic bypasses.
- **Result:** No secrets were found. The application correctly relies on server-side authentication state (`auth.currentUser`) and does not expose admin credentials in the client code.

### âœ… Finding #4: Brute Force Protection

- **Severity:** Low (Secure)
- **Status:** **SECURE**
- **Description:** Brute-force attacks against `admin@gyanniketan.com` were attempted.
- **Result:** Firebase correctly triggered `auth/too-many-requests` rate limiting after ~5 failed attempts.

---

## 2. Recommendations

### Immediate Actions

1.  **Disable Public Registration:**

    - Go to **Firebase Console -> Authentication -> Sign-in methods**.
    - Disable "Email/Password" provider OR uncheck "Enable" for new user creation.
    - _Alternative:_ Use a Cloud Function to automatically disable new accounts until they are manually verified by an administrator.

2.  **Monitor Usage:**
    - Check the Authentication tab for suspicious email addresses (e.g., `pentest_...`, random strings) and delete them.

### Long-Term Best Practices

- **Review Security Rules:** Ensure rules explicitly check for custom claims or specific UIDs (e.g., `request.auth.token.admin == true`) rather than simple authentication (`request.auth != null`).
- **Admin SDK:** Continue using Service Accounts for backend admin tasks to bypass these necessary client-side restrictions.

---

_Report generated by Automated Pentest Suite._
